using Npgsql.BackendMessages;

namespace Npgsql.Internal;

sealed class AuthenticationSm3PasswordMessage : AuthenticationRequestMessage
{
    internal override AuthenticationRequestType AuthRequestType => AuthenticationRequestType.Sm3Password;

    internal byte[] Salt { get; }

    internal static AuthenticationSm3PasswordMessage Load(NpgsqlReadBuffer buf)
    {
        var numArray = new byte[4];
        buf.ReadBytes(numArray, 0, 4);
        return new AuthenticationSm3PasswordMessage(numArray);
    }

    AuthenticationSm3PasswordMessage(byte[] salt) => Salt = salt;
}
